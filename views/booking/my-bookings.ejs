<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>My Bookings | OrbitRush Tourism</title>
    <%- include("../partials/head") %>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
    <style>
      body {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        padding: 2rem 0;
        font-family: "Inter", -apple-system, BlinkMacSystemFont, sans-serif;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 1.5rem;
      }

      .page-header {
        background: white;
        border-radius: 20px;
        padding: 2rem;
        margin-bottom: 2rem;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        text-align: center;
      }

      .page-header h1 {
        margin: 0;
        color: #2c3e50;
        font-size: 2.5rem;
        font-weight: 800;
      }

      .page-header p {
        margin: 0.5rem 0 0 0;
        color: #6c757d;
        font-size: 1.1rem;
      }

      .booking-card {
        background: white;
        border-radius: 20px;
        overflow: hidden;
        margin-bottom: 2rem;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
        transition: all 0.3s;
      }

      .booking-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 40px rgba(0, 0, 0, 0.25);
      }

      .booking-header {
        background: linear-gradient(135deg, #ff6b35, #f7931e);
        color: white;
        padding: 1.5rem 2rem;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .booking-header h3 {
        margin: 0;
        font-size: 1.5rem;
        font-weight: 700;
      }

      .booking-status {
        background: rgba(255, 255, 255, 0.3);
        padding: 0.5rem 1rem;
        border-radius: 20px;
        font-weight: 600;
        font-size: 0.9rem;
      }

      .booking-status.completed {
        background: #4caf50;
      }

      .booking-body {
        padding: 2rem;
      }

      .booking-details {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 1.5rem;
        margin-bottom: 2rem;
      }

      .detail-item {
        display: flex;
        flex-direction: column;
        gap: 0.3rem;
      }

      .detail-label {
        font-size: 0.85rem;
        color: #6c757d;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .detail-value {
        font-size: 1.1rem;
        color: #2c3e50;
        font-weight: 700;
      }

      .travelers-section {
        background: #f8f9fa;
        padding: 1.5rem;
        border-radius: 12px;
        margin-top: 1.5rem;
      }

      .travelers-title {
        font-weight: 700;
        color: #2c3e50;
        margin-bottom: 1rem;
        font-size: 1.1rem;
      }

      .traveler-item {
        background: white;
        padding: 1rem;
        border-radius: 8px;
        margin-bottom: 0.8rem;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .traveler-name {
        font-weight: 600;
        color: #2c3e50;
      }

      .traveler-aadhaar {
        font-family: monospace;
        color: #667eea;
        font-weight: 600;
      }

      .empty-state {
        background: white;
        border-radius: 20px;
        padding: 4rem 2rem;
        text-align: center;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
      }

      .empty-state i {
        font-size: 5rem;
        color: #e9ecef;
        margin-bottom: 1rem;
      }

      .empty-state h2 {
        color: #2c3e50;
        margin-bottom: 0.5rem;
      }

      .empty-state p {
        color: #6c757d;
        margin-bottom: 2rem;
      }

      .btn-browse {
        display: inline-block;
        padding: 1rem 2rem;
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white;
        text-decoration: none;
        border-radius: 50px;
        font-weight: 600;
        transition: all 0.3s;
      }

      .btn-browse:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
      }

      @media (max-width: 768px) {
        .booking-details {
          grid-template-columns: 1fr;
        }

        .booking-header {
          flex-direction: column;
          gap: 1rem;
        }
      }
    </style>
  </head>
  <body>
    <%- include("../partials/nav") %>

    <div class="container">
      <!-- Page Header -->
      <div class="page-header">
        <h1>ðŸŽ« My Bookings</h1>
        <p>View all your travel bookings and adventure plans</p>
      </div>

      <!-- Bookings List -->
      <% if (bookings && bookings.length > 0) { %> <%
      bookings.forEach(function(booking) { %>
      <div class="booking-card">
        <!-- Booking Header -->
        <div class="booking-header">
          <h3><%= booking.tourName %></h3>
          <span class="booking-status <%= booking.paymentStatus %>">
            âœ“ <%= booking.paymentStatus.toUpperCase() %>
          </span>
        </div>

        <!-- Booking Body -->
        <div class="booking-body">
          <div class="booking-details">
            <div class="detail-item">
              <span class="detail-label">Travel Date</span>
              <span class="detail-value">
                <% var travelDate = new Date(booking.travelDate); var
                formattedTravelDate = travelDate.toLocaleDateString('en-IN', {
                day: 'numeric', month: 'long', year: 'numeric' }); %> <%=
                formattedTravelDate %>
              </span>
            </div>

            <div class="detail-item">
              <span class="detail-label">Number of People</span>
              <span class="detail-value"
                ><%= booking.numberOfPeople %> Travelers</span
              >
            </div>

            <div class="detail-item">
              <span class="detail-label">Total Amount</span>
              <span class="detail-value"
                >â‚¹<%= booking.amount.toLocaleString('en-IN') %></span
              >
            </div>

            <div class="detail-item">
              <span class="detail-label">Booking Date</span>
              <span class="detail-value">
                <% var bookingDate = new Date(booking.createdAt); var
                formattedBookingDate = bookingDate.toLocaleDateString('en-IN', {
                day: 'numeric', month: 'short', year: 'numeric' }); %> <%=
                formattedBookingDate %>
              </span>
            </div>

            <div class="detail-item">
              <span class="detail-label">Payment ID</span>
              <span
                class="detail-value"
                style="font-size: 0.85rem; font-family: monospace"
              >
                <%= booking.paymentId %>
              </span>
            </div>

            <div class="detail-item">
              <span class="detail-label">Booking ID</span>
              <span
                class="detail-value"
                style="font-size: 0.85rem; font-family: monospace"
              >
                <%= booking._id.toString().substring(0, 12) %>...
              </span>
            </div>
          </div>

          <!-- Travelers Section -->
          <div class="travelers-section">
            <div class="travelers-title">
              <i class="fas fa-users"></i> Traveler Details
            </div>
            <% booking.travelers.forEach(function(traveler, index) { %>
            <div class="traveler-item">
              <span class="traveler-name">
                <i class="fas fa-user"></i> <%= index + 1 %>. <%= traveler.name
                %>
              </span>
              <span class="traveler-aadhaar">
                <% var aadhaar = traveler.aadhaarNumber; var formatted =
                aadhaar.substring(0,4) + '-' + aadhaar.substring(4,8) + '-' +
                aadhaar.substring(8,12); %> <%= formatted %>
              </span>
            </div>
            <% }); %>
          </div>
        </div>
      </div>
      <% }); %> <% } else { %>
      <!-- Empty State -->
      <div class="empty-state">
        <i class="fas fa-suitcase-rolling"></i>
        <h2>No Bookings Yet</h2>
        <p>Start your adventure by booking your first tour!</p>
        <a href="/tour" class="btn-browse">
          <i class="fas fa-compass"></i> Browse Tours
        </a>
      </div>
      <% } %>
    </div>

    <%- include("../partials/scripts") %>
  </body>
</html>
