<!DOCTYPE html>
<html lang="en">
  <head>
    <%- include("partials/head") %>
    <title>My Enquiries - OrbitRush Tourism</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Inter", sans-serif;
        background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
        min-height: 100vh;
      }

      .enquiries-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 2rem;
      }

      .page-header {
        background: white;
        border-radius: 20px;
        padding: 2rem;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
        margin-bottom: 2rem;
        text-align: center;
      }

      .page-title {
        font-size: 2.5rem;
        font-weight: 700;
        color: #1a1a1a;
        margin-bottom: 0.5rem;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 1rem;
      }

      .page-title i {
        color: #3b82f6;
        font-size: 2rem;
      }

      .page-subtitle {
        color: #64748b;
        font-size: 1.1rem;
        margin-bottom: 1.5rem;
      }

      .enquiry-stats {
        display: flex;
        justify-content: center;
        gap: 2rem;
        margin-top: 1rem;
      }

      .stat-card {
        background: #f8fafc;
        padding: 1rem 1.5rem;
        border-radius: 12px;
        text-align: center;
      }

      .stat-number {
        font-size: 1.8rem;
        font-weight: 700;
        color: #3b82f6;
        display: block;
      }

      .stat-label {
        font-size: 0.9rem;
        color: #64748b;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .enquiries-grid {
        display: grid;
        gap: 1.5rem;
      }

      .enquiry-card {
        background: white;
        border-radius: 16px;
        padding: 2rem;
        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.08);
        border-left: 5px solid #3b82f6;
        transition: all 0.3s ease;
      }

      .enquiry-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 50px rgba(0, 0, 0, 0.12);
      }

      .enquiry-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 1.5rem;
      }

      .enquiry-tour-name {
        font-size: 1.4rem;
        font-weight: 700;
        color: #1a1a1a;
        line-height: 1.3;
        flex: 1;
        margin-right: 1rem;
      }

      .enquiry-date {
        background: #f1f5f9;
        color: #475569;
        padding: 0.5rem 1rem;
        border-radius: 20px;
        font-size: 0.9rem;
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        white-space: nowrap;
      }

      .enquiry-details {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1.5rem;
        margin-bottom: 1.5rem;
      }

      .detail-item {
        display: flex;
        align-items: center;
        gap: 0.8rem;
      }

      .detail-item i {
        color: #3b82f6;
        width: 20px;
        text-align: center;
        flex-shrink: 0;
      }

      .detail-label {
        font-weight: 600;
        color: #64748b;
        font-size: 0.9rem;
      }

      .detail-value {
        color: #1a1a1a;
        font-weight: 500;
      }

      .enquiry-message {
        background: #f8fafc;
        border-radius: 12px;
        padding: 1.5rem;
        border-left: 4px solid #e2e8f0;
      }

      .message-label {
        font-weight: 600;
        color: #64748b;
        font-size: 0.9rem;
        margin-bottom: 0.8rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .message-label i {
        color: #3b82f6;
      }

      .message-text {
        color: #1a1a1a;
        line-height: 1.6;
        font-size: 1rem;
      }

      .empty-state {
        text-align: center;
        padding: 4rem 2rem;
        background: white;
        border-radius: 16px;
        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.08);
      }

      .empty-state i {
        font-size: 4rem;
        color: #cbd5e1;
        margin-bottom: 1.5rem;
      }

      .empty-state h3 {
        font-size: 1.5rem;
        color: #1a1a1a;
        margin-bottom: 1rem;
        font-weight: 600;
      }

      .empty-state p {
        color: #64748b;
        margin-bottom: 2rem;
        font-size: 1.1rem;
      }

      .btn-primary {
        background: linear-gradient(135deg, #3b82f6, #1d4ed8);
        color: white;
        padding: 1rem 2rem;
        border: none;
        border-radius: 12px;
        font-weight: 600;
        text-decoration: none;
        transition: all 0.3s ease;
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
      }

      .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 30px rgba(59, 130, 246, 0.4);
        color: white;
      }

      .actions-bar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 2rem;
        background: white;
        padding: 1.5rem;
        border-radius: 16px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
      }

      .filter-tabs {
        display: flex;
        gap: 0.5rem;
      }

      .filter-tab {
        padding: 0.5rem 1rem;
        border-radius: 8px;
        border: none;
        background: #f1f5f9;
        color: #64748b;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .filter-tab.active {
        background: #3b82f6;
        color: white;
      }

      .filter-tab:hover {
        background: #e2e8f0;
      }

      .filter-tab.active:hover {
        background: #2563eb;
      }

      @media (max-width: 768px) {
        .enquiries-container {
          padding: 1rem;
        }

        .page-title {
          font-size: 2rem;
          flex-direction: column;
          gap: 0.5rem;
        }

        .enquiry-stats {
          flex-direction: column;
          align-items: center;
        }

        .enquiry-header {
          flex-direction: column;
          align-items: flex-start;
          gap: 1rem;
        }

        .enquiry-tour-name {
          margin-right: 0;
        }

        .enquiry-details {
          grid-template-columns: 1fr;
          gap: 1rem;
        }

        .actions-bar {
          flex-direction: column;
          gap: 1rem;
        }

        .filter-tabs {
          flex-wrap: wrap;
          justify-content: center;
        }
      }
    </style>
  </head>

  <body>
    <%- include("partials/nav") %>

    <div class="enquiries-container">
      <!-- Page Header -->
      <div class="page-header">
        <h1 class="page-title">
          <i class="fas fa-clipboard-list"></i>
          My Enquiries
        </h1>
        <p class="page-subtitle">
          Track all your tour enquiries and their current status
        </p>

        <div class="enquiry-stats">
          <div class="stat-card">
            <span class="stat-number"><%= enquiries.length %></span>
            <span class="stat-label">Total Enquiries</span>
          </div>
          <div class="stat-card">
            <span class="stat-number">
              <%= enquiries.filter(e => new Date() - new Date(e.createdAt) <=
              7*24*60*60*1000).length %>
            </span>
            <span class="stat-label">This Week</span>
          </div>
        </div>
      </div>

      <!-- Actions Bar -->
      <div class="actions-bar">
        <div class="filter-tabs">
          <button class="filter-tab active" onclick="filterEnquiries('all')">
            All Enquiries
          </button>
          <button class="filter-tab" onclick="filterEnquiries('recent')">
            Recent
          </button>
        </div>
        <a href="/tour/enquire" class="btn-primary">
          <i class="fas fa-plus"></i>
          New Enquiry
        </a>
      </div>

      <!-- Enquiries List -->
      <div class="enquiries-grid" id="enquiriesGrid">
        <% if (enquiries && enquiries.length > 0) { %> <%
        enquiries.forEach(enquiry => { %>
        <div class="enquiry-card" data-date="<%= enquiry.createdAt %>">
          <div class="enquiry-header">
            <h3 class="enquiry-tour-name"><%= enquiry.tourName %></h3>
            <div class="enquiry-date">
              <i class="fas fa-calendar-alt"></i>
              <%= new Date(enquiry.createdAt).toLocaleDateString('en-US', {
              month: 'short', day: 'numeric', year: 'numeric' }) %>
            </div>
          </div>

          <div class="enquiry-details">
            <div class="detail-item">
              <i class="fas fa-users"></i>
              <div>
                <div class="detail-label">People</div>
                <div class="detail-value">
                  <%= enquiry.numberOfPeople %> Travelers
                </div>
              </div>
            </div>

            <div class="detail-item">
              <i class="fas fa-calendar-check"></i>
              <div>
                <div class="detail-label">Preferred Date</div>
                <div class="detail-value">
                  <% if (enquiry.preferredDate) { %> <%= new
                  Date(enquiry.preferredDate).toLocaleDateString('en-US', {
                  month: 'long', day: 'numeric', year: 'numeric' }) %> <% } else
                  { %> Flexible <% } %>
                </div>
              </div>
            </div>

            <div class="detail-item">
              <i class="fas fa-phone"></i>
              <div>
                <div class="detail-label">Contact</div>
                <div class="detail-value"><%= enquiry.phone %></div>
              </div>
            </div>

            <div class="detail-item">
              <i class="fas fa-envelope"></i>
              <div>
                <div class="detail-label">Email</div>
                <div class="detail-value"><%= enquiry.email %></div>
              </div>
            </div>
          </div>

          <% if (enquiry.message) { %>
          <div class="enquiry-message">
            <div class="message-label">
              <i class="fas fa-comment-dots"></i>
              Your Message
            </div>
            <p class="message-text"><%= enquiry.message %></p>
          </div>
          <% } %>
        </div>
        <% }) %> <% } else { %>
        <div class="empty-state">
          <i class="fas fa-clipboard-list"></i>
          <h3>No Enquiries Yet</h3>
          <p>
            You haven't made any tour enquiries yet. Start planning your next
            adventure!
          </p>
          <a href="/tour/enquire" class="btn-primary">
            <i class="fas fa-paper-plane"></i>
            Make Your First Enquiry
          </a>
        </div>
        <% } %>
      </div>
    </div>
    <%- include("partials/footer") %> <%- include("partials/scripts") %>

    <script>
      function filterEnquiries(filter) {
        const cards = document.querySelectorAll(".enquiry-card");
        const tabs = document.querySelectorAll(".filter-tab");

        // Update active tab
        tabs.forEach((tab) => tab.classList.remove("active"));
        event.target.classList.add("active");

        if (filter === "all") {
          cards.forEach((card) => (card.style.display = "block"));
        } else if (filter === "recent") {
          const oneWeekAgo = new Date();
          oneWeekAgo.setDate(oneWeekAgo.getDate() - 7);

          cards.forEach((card) => {
            const cardDate = new Date(card.getAttribute("data-date"));
            card.style.display = cardDate > oneWeekAgo ? "block" : "none";
          });
        }
      }

      // Add smooth animations
      document.addEventListener("DOMContentLoaded", function () {
        const cards = document.querySelectorAll(".enquiry-card");
        cards.forEach((card, index) => {
          card.style.opacity = "0";
          card.style.transform = "translateY(20px)";
          setTimeout(() => {
            card.style.transition = "all 0.5s ease";
            card.style.opacity = "1";
            card.style.transform = "translateY(0)";
          }, index * 100);
        });
      });
    </script>
  </body>
</html>
